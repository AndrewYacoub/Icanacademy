<h1><%= @homework.title %></h1>

<div class="card mb-4">
  <div class="card-body">
    <h5 class="card-title"><strong>Lesson:</strong> <%= @homework.lesson %></h5>
    <p class="card-text"><strong>Description:</strong> <%= @homework.description %></p>
    <p class="card-text"><strong>Google Form:</strong></p>
    <% if @homework.google_form_link.present? %>
      <iframe id="homework-form-iframe" src="<%= @homework.google_form_link %>" width="100%" height="600px" frameborder="0" marginheight="0" marginwidth="0">Loadingâ€¦</iframe>
    <% else %>
      <p>No Google Form link provided.</p>
    <% end %>
    <% if @homework.file.attached? %>
      <p class="card-text"><strong>File:</strong> <%= link_to 'Download', url_for(@homework.file), class: 'btn btn-outline-primary btn-sm' %></p>
    <% end %>
  </div>
</div>


<%= link_to 'Back', course_group_homeworks_path(@homework.group.course, @homework.group), class: 'btn btn-secondary' %>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const iframe = document.getElementById('homework-form-iframe');

  iframe.onload = () => {
    const iframeDocument = iframe.contentDocument || iframe.contentWindow.document;
    
    const viewScoreButton = iframeDocument.querySelector('a[href*="viewscore"]');

    if (viewScoreButton) {
      viewScoreButton.addEventListener('click', (event) => {
        event.preventDefault();
        const viewScoreUrl = viewScoreButton.href;
        iframe.src = viewScoreUrl;
      });
    }
  };
});
</script>

